!function(){var t,e,n=this&&this.__extends||(t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.remove=function(t){var n=new e;return this.filter(function(t){}).forEach(function(t){n.push(t)}),n},e.prototype.distinct=function(){var t=new e;return this.sort().filter(function(t,e,n){return!e||t!=n[e-1]}).forEach(function(e){t.push(e)}),t},e.prototype.count=function(){return this.length||0},e.prototype.orderBy=function(t,e,n){var r=n?function(e){return n(e[t])}:function(e){return e[t]};return e="desc"===e?-1:1,this.sort(function(t,n){var i=r(t),s=r(n);return e*((i>s)-(s>i))})},e.prototype.avg=function(t){if(this.count()>0){var e=[];return this.forEach(function(n){e.push(n[t])}),e.reduce(function(t,e){return t+e})/this.count()}return 0},e.prototype.last=function(){return this[this.count()-1]},e.prototype.first=function(){return this[0]},e.prototype.head=function(){var t=new e;return this.length>0&&t.push(this[0]),t},e.prototype.lst=function(){var t=new e;return this.length>0&&t.push(this[this.length-1]),t},e.prototype.tail=function(){return this.length>0&&this.shift(),this},e.prototype.init=function(){return this.length>0&&this.pop(),this},e}(Array);class i{constructor(t,e){return this.data=new Object,this.container=new Object,this.autoIncrementableId=(t=>{let e=t.prototype.constructor.name;return this.data[e]?this.data[e].id?this.data[e].id=this.data[e].id+1:this.data[e].id=i.baseId:this.data[e]={id:i.baseId},this.data[e].id}),this.setupClass=((t,e,n)=>{Object.keys(e).forEach(i=>{e[i]instanceof Object&&!(e[i]instanceof Array)?n.__types&&n.__types[i]?(t[i]=new n.__types[i]({}),this.setupClass(t[i],e[i],n.__types[i])):t[i]=e[i]:e[i]instanceof Array?(t[i]=new r,e[i].forEach(r=>{n.__types?n.__types[i]&&n.__types[i]instanceof Array&&n.__types[i].length>0?(t[i].push(new n.__types[i][0](r)),this.setupClass(t[i].last(),r,n.__types[i][0])):t[i]=r:t[i]=e[i]})):t[i]=e[i]})}),this.container=t||window,this.reset()}reset(){return i.baseId=1,this.data=new Object,this}instanceof(t){return"Bhdr"===t.prototype.constructor.name}createTable(t,e){let n=t.prototype.constructor.name;return this.data[n]?this.data[n]:(this.data[n]={id:i.baseId},e?e(this.data[n]):this.data[n])}dropTable(t,e){let n=t.prototype.constructor.name;return this.data[n]&&(e&&e(this.data[n]),delete this.data[n]),null}insert(t,e,n){let r=t.prototype.constructor.name;return this.data[r]||(this.data[r]={}),e instanceof t?(this.data[r][this.autoIncrementableId(t)]=e,n?n(e):e):e}update(t,e,n,r){let i=t.prototype.constructor.name;return this.data[i]&&e instanceof t?(this.data[i][this.getId(t,e)]=n,r?r(n):n):e}delete(t,e,n){let r=t.prototype.constructor.name;return this.data[r]&&e instanceof t&&Object.keys(this.data[r]).forEach(t=>{if(this.data[r][t]===e)return delete this.data[r][t],n?n(e):e}),e}find(t,e){let n=this.findBy(t,e)||new r;return n.length>0?n[0]:null}findBy(t,e){let n=t.prototype.constructor.name,i=new r;return this.data[n]&&Object.keys(e).forEach(t=>{Object.keys(this.data[n]).forEach(r=>{this.data[n][r][t]&&this.data[n][r][t]===e[t]&&i.push(this.data[n][r])})}),i}findByI(t,e){let n=t.prototype.constructor.name,i=new r;return this.data[n]&&Object.keys(e).forEach(t=>{Object.keys(this.data[n]).forEach(r=>{this.data[n][r][t]&&this.data[n][r][t].toString().toLowerCase()===e[t].toString().toLowerCase()&&i.push(this.data[n][r])})}),i}findByLike(t,e){let n=t.prototype.constructor.name,i=new r,s=new r,a=new r;return Object.keys(this.data[n]).forEach(t=>{"id"!==t&&i.push(this.data[n][t])}),this.data[n]&&(Object.keys(e).forEach(t=>{i.forEach(n=>{n[t]&&-1!==n[t].toString().indexOf(e[t].toString())&&s.push(n)}),i=s,s=new r}),a=i),a}findByILike(t,e){let n=t.prototype.constructor.name,i=new r,s=new r,a=new r;return Object.keys(this.data[n]).forEach(t=>{"id"!==t&&i.push(this.data[n][t])}),this.data[n]&&(Object.keys(e).forEach(t=>{i.forEach(n=>{n[t]&&-1!==n[t].toString().toLowerCase().indexOf(e[t].toString().toLowerCase())&&s.push(n)}),i=s,s=new r}),a=i),a}findAll(t){let e=t.prototype.constructor.name,n=new r;return this.data[e]&&Object.keys(this.data[e]).forEach(t=>{"id"!==t&&n.push(this.data[e][t])}),n}findWhere(t,e){let n=t.prototype.constructor.name,i=new r;return this.data[n]&&Object.keys(this.data[n]).forEach(t=>{"id"!==t&&e(this.data[n][t])&&i.push(this.data[n][t])}),i}map(){let t=Array.prototype.slice.call(arguments);t&&t.length>0&&t.forEach(t=>(t.add=((e,n)=>this.insert(t,e,n)),t.update=((e,n,r)=>this.update(t,e,n,r)),t.remove=((e,n)=>this.delete(t,e,n)),t.find=(e=>this.find(t,e)),t.findBy=(e=>this.findBy(t,e)),t.findByI=(e=>this.findByI(t,e)),t.findByLike=(e=>this.findByLike(t,e)),t.findByILike=(e=>this.findByILike(t,e)),t.findAll=(()=>this.findAll(t)),t.findWhere=(e=>this.findWhere(t,e)),t.get=(e=>this.get(t,e)),t.getId=(e=>this.getId(t,e)),t.createTable=(e=>this.createTable(t,e)),t.dropTable=(e=>this.dropTable(t,e)),t.prototype.save=function(e){return t.add(this,e)},t.prototype.delete=function(e){return t.remove(this,e)},t.prototype.update=function(e,n){return t.update(this,e,n)},t.prototype.id=function(){return t.getId(this)},t))}get(t,e){let n=t.prototype.constructor.name;return this.data[n]&&this.data[n][e]||null}getId(t,e){let n=t.prototype.constructor.name;if(this.data[n]){let t=new r;return Object.keys(this.data[n]).forEach(r=>{this.data[n][r]===e&&t.push(r)}),t.length>0?t[0]:null}return null}export(t,e){let n;switch(t){case"javascript":n=this.data;break;case"json":n=e?JSON.stringify(this.data,null,e):JSON.stringify(this.data);break;case"bwf":n="Bhdr: "+JSON.stringify(this.data).trim().split(/"/).join(" ").split(/{/).join(" { ").split(/}/).join(" } ").split(/\[/).join(" [ ").split(/\]/).join(" ] ").split(/ :/).join(": ").split(/ ,/).join(", ").split(/  /).join(" ").trim()}return n}import(t,e){let n=!1;switch(e){case"javascript":this.data=t,n=!0;break;case"json":let r=new Object,i=JSON.parse(t);Object.keys(i).forEach(t=>{r[t]=new Object,Object.keys(i[t]).forEach(e=>{"id"===e?r[t][e]=i[t][e]:(this.container[t]?r[t][e]=new this.container[t]({}):r[t][e]=new Object,this.setupClass(r[t][e],i[t][e],this.container[t]))})}),this.import(r,"javascript"),n=!0}return n}}i.baseId=1,e=i,window.Bhdr=e}();